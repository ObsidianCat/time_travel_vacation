"use strict";var __decorate=this&&this.__decorate||function(e,t,o,i){var n,a=arguments.length,r=3>a?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(r=(3>a?n(r):a>3?n(t,o,r):n(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r},__metadata=this&&this.__metadata||function(e,t){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(e,t):void 0},core_1=require("@angular/core"),router_1=require("@angular/router"),destination_data_handler_service_1=require("../services/destination-data-handler.service"),destination_1=require("../models/destination"),advice_form_component_1=require("./advice-form.component"),book_form_component_1=require("./book-form.component"),DestViewComponent=function(){function e(e,t){this.dataHandlerService=e,this.route=t,this.destination=new destination_1.DestinationModel("","",[],[],[],[]),this.isBookFormVisible=!1,this.isAdviceFormVisible=!1}return e.prototype.ngOnInit=function(){var e=this;this.sub=this.route.params.subscribe(function(t){var o=t.id;e.dataHandlerService.getDestinationById(o).then(function(t){Object.assign(e.destination,t)})})},e.prototype.ngOnDestroy=function(){this.sub.unsubscribe()},e.prototype.newAdviceAdded=function(e){this.destination.advices.push(e.data)},e.prototype.newBookAdded=function(e){this.destination.books.push(e.data),this.isBookFormVisible=!1,console.log(this.destination)},e.prototype.likeDestination=function(e){var t=this;e.disabled=!0,this.dataHandlerService.likeDestination(this.destination._id).then(function(e){t.destination.likes=e})["catch"](function(e){console.error(e)})},e.prototype.tagVote=function(e,t,o,i){o.alreadyVoted||(console.log(this.destination._id,e,t,o._id),this.dataHandlerService.voteForTag(this.destination._id,{tagId:o._id,tagType:t,voteType:e}).then(function(t){"up"==e?o.votes++:o.votes--,o.alreadyVoted=!0})["catch"](function(e){console.error(e)}))},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"destination",void 0),e=__decorate([core_1.Component({selector:"destination-view",templateUrl:"vacation-chooser/templates/dest-view.component.html",styleUrls:["vacation-chooser/styles/dest-view.component.css"],directives:[advice_form_component_1.AdviceFormComponent,book_form_component_1.BookFormComponent]}),__metadata("design:paramtypes",[destination_data_handler_service_1.DestinationDataHandlerService,router_1.ActivatedRoute])],e)}();exports.DestViewComponent=DestViewComponent;